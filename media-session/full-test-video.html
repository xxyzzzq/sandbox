<!DOCTYPE html>
<html>
<head>
    <title>Media Session Test page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <video id="video"></video>
    <button type="button" id="previous-track-button">Previous track</button>
    <button type="button" id="play-pause-button">Play/pause</button>
    <button type="button" id="next-track-button">Next track</button>
    <br/>
    * Music obtained from www.bensound.com under Creative Commons License.
</body>
<script>

var tracks = [
  {
    src: "../media/BigBuck.m4v",
    metadata: new MediaMetadata({title:"BigBuck1", artwork: [{ src: "images/icon_1.png" }]})
  },
  {
    src: "../media/BigBuck.webm",
    metadata: new MediaMetadata({title:"BigBuck2", artwork: [{ src: "images/icon_2.png" }]})
  },
]

var trackId = 0;

var playPauseButton = document.getElementById("play-pause-button");
var previousTrackButton = document.getElementById("previous-track-button");
var nextTrackButton = document.getElementById("next-track-button");

var video = document.getElementById("video");

function updateTrack() {
  video.src = tracks[trackId].src;
  window.navigator.mediaSession.metadata = tracks[trackId].metadata;
  video.play();
}

function selectPreviousTrack() {
  trackId = (trackId + tracks.length - 1) % tracks.length;
  updateTrack();
}

function selectNextTrack() {
  trackId = (trackId + 1) % tracks.length;
  updateTrack();
}

function togglePlayPause() {
  if (video.src) {
    if (video.paused)
      video.play();
    else
      video.pause();
  } else {
    updateTrack();
  }
}

playPauseButton.onclick = togglePlayPause;
previousTrackButton.onclick = selectPreviousTrack;
nextTrackButton.onclick = selectNextTrack;

window.navigator.mediaSession.onprevioustrack = selectPreviousTrack;
window.navigator.mediaSession.onnexttrack = selectNextTrack;

</script>
</html>
